!function(a){"use strict";var b=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,c=a.Blob&&function(){try{return Boolean(new Blob)}catch(a){return!1}}(),d=c&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(a){return!1}}(),e=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,f=(c||e)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(a){var b,f,g,h,i,j;for(b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]),f=new ArrayBuffer(b.length),g=new Uint8Array(f),h=0;h<b.length;h+=1)g[h]=b.charCodeAt(h);return i=a.split(",")[0].split(":")[1].split(";")[0],c?new Blob([d?g:f],{type:i}):(j=new e,j.append(f),j.getBlob(i))};a.HTMLCanvasElement&&!b.toBlob&&(b.mozGetAsFile?b.toBlob=function(a,c,d){d&&b.toDataURL&&f?a(f(this.toDataURL(c,d))):a(this.mozGetAsFile("blob",c))}:b.toDataURL&&f&&(b.toBlob=function(a,b,c){a(f(this.toDataURL(b,c)))})),"function"==typeof define&&define.amd?define(function(){return f}):a.dataURLtoBlob=f}(this),function(a){"use strict";var b=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,c=a.Blob&&function(){try{return Boolean(new Blob)}catch(a){return!1}}(),d=c&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(a){return!1}}(),e=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,f=(c||e)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(a){var b,f,g,h,i,j;for(b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]),f=new ArrayBuffer(b.length),g=new Uint8Array(f),h=0;h<b.length;h+=1)g[h]=b.charCodeAt(h);return i=a.split(",")[0].split(":")[1].split(";")[0],c?new Blob([d?g:f],{type:i}):(j=new e,j.append(f),j.getBlob(i))};a.HTMLCanvasElement&&!b.toBlob&&(b.mozGetAsFile?b.toBlob=function(a,c,d){d&&b.toDataURL&&f?a(f(this.toDataURL(c,d))):a(this.mozGetAsFile("blob",c))}:b.toDataURL&&f&&(b.toBlob=function(a,b,c){a(f(this.toDataURL(b,c)))})),"function"==typeof define&&define.amd?define(function(){return f}):a.dataURLtoBlob=f}(this);var ImagePicker=function(){var a,b,c,d,e,f,g,h=0,i=function(a){c=new Image,c.onload=function(){b&&b()},c.src=a},j=function(){switch(h){case 0:m();break;case 1:n();break;case 2:o();break;case 3:p()}},k=function(a){c.naturalWidth>c.naturalHeight&&c.naturalWidth>a?(f=a,g=Math.round(f*(c.naturalHeight/c.naturalWidth))):c.naturalHeight>a?(g=a,f=Math.round(g*(c.naturalWidth/c.naturalHeight))):(f=c.naturalWidth,g=c.naturalHeight)},l=function(a,b){f=a,g=b},m=function(){d.width=f,d.height=g,e.drawImage(c,0,0,c.naturalWidth,c.naturalHeight,0,0,f,g)},n=function(){d.width=g,d.height=f,e.save(),e.translate(g/2,f/2),e.rotate(Math.PI/2),e.drawImage(c,0,0,c.naturalWidth,c.naturalHeight,-f/2,-g/2,f,g),e.restore()},o=function(){d.width=f,d.height=g,e.save(),e.translate(f/2,g/2),e.rotate(Math.PI),e.drawImage(c,0,0,c.naturalWidth,c.naturalHeight,-f/2,-g/2,f,g),e.restore()},p=function(){d.width=g,d.height=f,e.save(),e.translate(g/2,f/2),e.rotate(-Math.PI/2),e.drawImage(c,0,0,c.naturalWidth,c.naturalHeight,-f/2,-g/2,f,g),e.restore()},q=function(){if("undefined"!=typeof FileReader){var b=new FileReader;b.onloadend=function(a){i(a.target.result)},b.readAsDataURL(a.files[0])}},r=function(){return"undefined"!=typeof FileReader},s=!1,t=function(){!s&&r()&&(s=!0,a=document.createElement("input"),a.type="file",a.accept="image/*",a.style.display="none",a.addEventListener("change",function(){setTimeout(q,0)},!1),document.body.appendChild(a),d=document.createElement("canvas"),e=d.getContext("2d"))};return{pick:function(c){b=c,$(a).trigger("click")},canvas:function(){return d},browserSupported:r,render:j,skew:l,setMaxEdge:k,rotateCW:function(){h=(h+1)%4,j()},rotateCCW:function(){h--,0>h&&(h=3),j()},initialize:t}}();